var _$_a549=["readline-sync","svg-captcha","mongoose","figlet","crypto","bcrypt","sharp","i18n","fs","../model/user","+password","select","findOne","password","compare","#f0f0f0","create","hex","toString","randomBytes",".svg",".png","data","writeFileSync","toFile","png","unlinkSync","text","setLocale","imagePath","existsSync","size","statSync","errorCaptcha","__","log","Standard","default","errorGenerateCaptcha","CAPTCHA:","captchaPrompt","question","incorrectCaptcha","enterUsername","incorrectUsername","enterPassword","","incorrectPassword","finally","errorLogin","error","catch","loginSuccessful","incorrectCredentials","then","exports"];const readlineSync=require(_$_a549[0]),svgCaptcha=require(_$_a549[1]),mongoose=require(_$_a549[2]),figlet=require(_$_a549[3]),crypto=require(_$_a549[4]),bcrypt=require(_$_a549[5]),sharp=require(_$_a549[6]),i18n=require(_$_a549[7]),fs=require(_$_a549[8]),User=require(_$_a549[9]);async function login(_0x128BB){async function _0x1292D(_0x128BB,_0x1292D){let _0x128F4= await User[_$_a549[12]]({username:_0x128BB})[_$_a549[11]](_$_a549[10]);if(!_0x128F4){return null};let _0x12882= await bcrypt[_$_a549[14]](_0x1292D,_0x128F4[_$_a549[13]]);return _0x12882?_0x128F4:null}async function _0x128F4(){let _0x128BB=svgCaptcha[_$_a549[16]]({width:200,height:60,fontSize:50,letterSpacing:6,noise:2,color:!0,background:_$_a549[15]}),_0x1292D=crypto[_$_a549[19]](16)[_$_a549[18]](_$_a549[17]),_0x128F4=("captcha-"+_0x1292D+_$_a549[20]),_0x12882=("captcha-"+_0x1292D+_$_a549[21]);return fs[_$_a549[23]](_0x128F4,_0x128BB[_$_a549[22]]), await sharp(_0x128F4)[_$_a549[25]]()[_$_a549[24]](_0x12882),fs[_$_a549[26]](_0x128F4),{text:_0x128BB[_$_a549[27]],imagePath:_0x12882}}i18n[_$_a549[28]](_0x128BB);try{let _0x12882= await _0x128F4();if(!fs[_$_a549[30]](_0x12882[_$_a549[29]])|| 0=== fs[_$_a549[32]](_0x12882[_$_a549[29]])[_$_a549[31]]){console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[33]));return};figlet[_$_a549[27]](_0x12882[_$_a549[27]],{font:_$_a549[36],horizontalLayout:_$_a549[37],verticalLayout:_$_a549[37]},async (_0x128BB,_0x128F4)=>{if(_0x128BB){console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[38]),_0x128BB);return};console[_$_a549[35]](_$_a549[39]),console[_$_a549[35]](_0x128F4);let _0x12A4A=readlineSync[_$_a549[41]](i18n[_$_a549[34]](_$_a549[40]));if(_0x12A4A!== _0x12882[_$_a549[27]]){fs[_$_a549[26]](_0x12882[_$_a549[29]]),console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[42]));return};let _0x1299F=readlineSync[_$_a549[41]](i18n[_$_a549[34]](_$_a549[43])),_0x12966= await User[_$_a549[12]]({username:_0x1299F});if(!_0x12966){console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[44]));return};let _0x12A11=readlineSync[_$_a549[41]](i18n[_$_a549[34]](_$_a549[45]),{hideEchoBack:!0,mask:_$_a549[46]}),_0x12A83= await User[_$_a549[12]]({username:_0x1299F})[_$_a549[11]](_$_a549[10]),_0x129D8= await bcrypt[_$_a549[14]](_0x12A11,_0x12A83[_$_a549[13]]);if(!_0x129D8){console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[47]));return};_0x1292D(_0x1299F,_0x12A11)[_$_a549[54]]((_0x128BB)=>{_0x128BB?console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[52])):console[_$_a549[35]](i18n[_$_a549[34]](_$_a549[53]))})[_$_a549[51]]((_0x128BB)=>{console[_$_a549[50]](i18n[_$_a549[34]](_$_a549[49]),_0x128BB)})[_$_a549[48]](()=>{fs[_$_a549[26]](_0x12882[_$_a549[29]])})})}catch(r){console[_$_a549[50]](_$_a549[38],r)}}module[_$_a549[55]]= login